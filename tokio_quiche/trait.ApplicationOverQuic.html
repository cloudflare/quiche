<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A trait to implement an application served over QUIC."><title>ApplicationOverQuic in tokio_quiche - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Italic-81dc35de.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-MediumItalic-ccf7e434.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2"href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../static.files/rustdoc-ca0dd0c4.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="tokio_quiche" data-themes="" data-resource-suffix="" data-rustdoc-version="1.93.0-nightly (292be5c7c 2025-10-29)" data-channel="nightly" data-search-js="search-d69d8955.js" data-stringdex-js="stringdex-c3e638e9.js" data-settings-js="settings-c38705f0.js" ><script src="../static.files/storage-e2aeef58.js"></script><script defer src="sidebar-items.js"></script><script defer src="../static.files/main-ce535bd0.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-263c88ec.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-eab170b8.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-044be391.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><rustdoc-topbar><h2><a href="#">ApplicationOverQuic</a></h2></rustdoc-topbar><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../tokio_quiche/index.html">tokio_<wbr>quiche</a><span class="version">0.10.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Application<wbr>Over<wbr>Quic</a></h2><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.buffer" title="buffer">buffer</a></li><li><a href="#tymethod.on_conn_established" title="on_conn_established">on_conn_established</a></li><li><a href="#tymethod.process_reads" title="process_reads">process_reads</a></li><li><a href="#tymethod.process_writes" title="process_writes">process_writes</a></li><li><a href="#tymethod.should_act" title="should_act">should_act</a></li><li><a href="#tymethod.wait_for_data" title="wait_for_data">wait_for_data</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.on_conn_close" title="on_conn_close">on_conn_close</a></li></ul><h3><a href="#dyn-compatibility">Dyn Compatibility</a></h3><h3><a href="#implementors">Implementors</a></h3></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="index.html">In crate tokio_<wbr>quiche</a></h2></div></div></nav><div class="sidebar-resizer" title="Drag to resize sidebar"></div><main><div class="width-limiter"><section id="main-content" class="content"><div class="main-heading"><div class="rustdoc-breadcrumbs"><a href="index.html">tokio_quiche</a></div><h1>Trait <span class="trait">Application<wbr>Over<wbr>Quic</span>&nbsp;<button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../src/tokio_quiche/quic/connection/mod.rs.html#670-754">Source</a> </span></div><pre class="rust item-decl"><code>pub trait ApplicationOverQuic: <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + 'static {
    // Required methods
    fn <a href="#tymethod.on_conn_established" class="fn">on_conn_established</a>(
        &amp;mut self,
        qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>,
        handshake_info: &amp;<a class="struct" href="quic/struct.HandshakeInfo.html" title="struct tokio_quiche::quic::HandshakeInfo">HandshakeInfo</a>,
    ) -&gt; <a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.should_act" class="fn">should_act</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.buffer" class="fn">buffer</a>(&amp;mut self) -&gt; &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>] <a href="#" class="tooltip" data-notable-ty="&amp;mut [u8]">ⓘ</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.wait_for_data" class="fn">wait_for_data</a>(
        &amp;mut self,
        qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>,
    ) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.process_reads" class="fn">process_reads</a>(&amp;mut self, qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>) -&gt; <a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.process_writes" class="fn">process_writes</a>(&amp;mut self, qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>) -&gt; <a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;;

    // Provided method
    fn <a href="#method.on_conn_close" class="fn">on_conn_close</a>&lt;M: <a class="trait" href="metrics/trait.Metrics.html" title="trait tokio_quiche::metrics::Metrics">Metrics</a>&gt;(
        &amp;mut self,
        qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>,
        metrics: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;M</a>,
        connection_result: &amp;<a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;,
    ) { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A trait to implement an application served over QUIC.</p>
<p>The application is driven by an internal worker task, which also handles I/O
for the connection. The worker feeds inbound packets into the
<a href="../quiche/struct.Connection.html" title="struct quiche::Connection">quiche::Connection</a>, calls <a href="trait.ApplicationOverQuic.html#tymethod.process_reads" title="method tokio_quiche::ApplicationOverQuic::process_reads"><code>ApplicationOverQuic::process_reads</code></a> followed
by <a href="trait.ApplicationOverQuic.html#tymethod.process_writes" title="method tokio_quiche::ApplicationOverQuic::process_writes"><code>ApplicationOverQuic::process_writes</code></a>, and then flushes any pending
outbound packets to the network. This repeats in a loop until either the
connection is closed or the <a href="trait.ApplicationOverQuic.html" title="trait tokio_quiche::ApplicationOverQuic"><code>ApplicationOverQuic</code></a> returns an error.</p>
<p>In between loop iterations, the worker yields until a new packet arrives, a
timer expires, or <a href="trait.ApplicationOverQuic.html#tymethod.wait_for_data" title="method tokio_quiche::ApplicationOverQuic::wait_for_data"><code>ApplicationOverQuic::wait_for_data</code></a> resolves.
Implementors can interact with the underlying connection via the mutable
reference passed to trait methods.</p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.on_conn_established" class="method"><a class="src rightside" href="../src/tokio_quiche/quic/connection/mod.rs.html#677-679">Source</a><h4 class="code-header">fn <a href="#tymethod.on_conn_established" class="fn">on_conn_established</a>(
    &amp;mut self,
    qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>,
    handshake_info: &amp;<a class="struct" href="quic/struct.HandshakeInfo.html" title="struct tokio_quiche::quic::HandshakeInfo">HandshakeInfo</a>,
) -&gt; <a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Callback to customize the <a href="trait.ApplicationOverQuic.html" title="trait tokio_quiche::ApplicationOverQuic"><code>ApplicationOverQuic</code></a> after the QUIC
handshake completed successfully.</p>
<h5 id="errors"><a class="doc-anchor" href="#errors">§</a>Errors</h5>
<p>Returning an error from this method immediately stops the worker loop
and transitions to the connection closing stage.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.should_act" class="method"><a class="src rightside" href="../src/tokio_quiche/quic/connection/mod.rs.html#686">Source</a><h4 class="code-header">fn <a href="#tymethod.should_act" class="fn">should_act</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Determines whether the application’s methods will be called by the
worker.</p>
<p>The function is checked in each iteration of the worker loop. Only
<code>on_conn_established()</code> and <code>buffer()</code> bypass this check.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.buffer" class="method"><a class="src rightside" href="../src/tokio_quiche/quic/connection/mod.rs.html#697">Source</a><h4 class="code-header">fn <a href="#tymethod.buffer" class="fn">buffer</a>(&amp;mut self) -&gt; &amp;mut [<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>] <a href="#" class="tooltip" data-notable-ty="&amp;mut [u8]">ⓘ</a></h4></section></summary><div class="docblock"><p>A borrowed buffer for the worker to write outbound packets into.</p>
<p>This method allows sharing a buffer between the worker and the
application, efficiently using the allocated memory while the
application is inactive. It can also be used to artificially
restrict the size of outbound network packets.</p>
<p>Any data in the buffer may be overwritten by the worker. If necessary,
the application should save the contents when this method is called.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.wait_for_data" class="method"><a class="src rightside" href="../src/tokio_quiche/quic/connection/mod.rs.html#715-717">Source</a><h4 class="code-header">fn <a href="#tymethod.wait_for_data" class="fn">wait_for_data</a>(
    &amp;mut self,
    qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>,
) -&gt; impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/future/future/trait.Future.html" title="trait core::future::future::Future">Future</a>&lt;Output = <a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;&gt; + <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a></h4></section></summary><div class="docblock"><p>Waits for an event to trigger the next iteration of the worker loop.</p>
<p>The returned future is awaited in parallel to inbound packets and the
connection’s timers. Any one of those futures resolving triggers the
next loop iteration, so implementations should not rely on
<code>wait_for_data</code> for the bulk of their processing. Instead, after
<code>wait_for_data</code> resolves, <code>process_writes</code> should be used to pull all
available data out of the event source (for example, a channel).</p>
<p>As for any future, it is <strong>very important</strong> that this method does not
block the runtime. If it does, the other concurrent futures will be
starved.</p>
<h5 id="errors-1"><a class="doc-anchor" href="#errors-1">§</a>Errors</h5>
<p>Returning an error from this method immediately stops the worker loop
and transitions to the connection closing stage.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.process_reads" class="method"><a class="src rightside" href="../src/tokio_quiche/quic/connection/mod.rs.html#728">Source</a><h4 class="code-header">fn <a href="#tymethod.process_reads" class="fn">process_reads</a>(&amp;mut self, qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>) -&gt; <a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Processes data received on the connection.</p>
<p>This method is only called if <code>should_act()</code> returns <code>true</code> and any
packets were received since the last worker loop iteration. It
should be used to read from the connection’s open streams.</p>
<h5 id="errors-2"><a class="doc-anchor" href="#errors-2">§</a>Errors</h5>
<p>Returning an error from this method immediately stops the worker loop
and transitions to the connection closing stage.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.process_writes" class="method"><a class="src rightside" href="../src/tokio_quiche/quic/connection/mod.rs.html#741">Source</a><h4 class="code-header">fn <a href="#tymethod.process_writes" class="fn">process_writes</a>(&amp;mut self, qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>) -&gt; <a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Adds data to be sent on the connection.</p>
<p>Unlike <code>process_reads</code>, this method is called on every iteration of the
worker loop (provided <code>should_act()</code> returns true). It is called
after <code>process_reads</code> and immediately before packets are pushed to
the socket. The main use case is providing already-buffered data to
the <a href="../quiche/struct.Connection.html" title="struct quiche::Connection">quiche::Connection</a>.</p>
<h5 id="errors-3"><a class="doc-anchor" href="#errors-3">§</a>Errors</h5>
<p>Returning an error from this method immediately stops the worker loop
and transitions to the connection closing stage.</p>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.on_conn_close" class="method"><a class="src rightside" href="../src/tokio_quiche/quic/connection/mod.rs.html#749-753">Source</a><h4 class="code-header">fn <a href="#method.on_conn_close" class="fn">on_conn_close</a>&lt;M: <a class="trait" href="metrics/trait.Metrics.html" title="trait tokio_quiche::metrics::Metrics">Metrics</a>&gt;(
    &amp;mut self,
    qconn: &amp;mut <a class="type" href="quic/type.QuicheConnection.html" title="type tokio_quiche::quic::QuicheConnection">QuicheConnection</a>,
    metrics: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;M</a>,
    connection_result: &amp;<a class="type" href="type.QuicResult.html" title="type tokio_quiche::QuicResult">QuicResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;,
)</h4></section></summary><div class="docblock"><p>Callback to inspect the result of the worker task, before a final packet
with a <code>CONNECTION_CLOSE</code> frame is flushed to the network.</p>
<p><code>connection_result</code> is <a href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html#variant.Ok" title="variant core::result::Result::Ok"><code>Ok</code></a> only if the connection was closed without
any local error. Otherwise, the state of <code>qconn</code> depends on the
error type and application behavior.</p>
</div></details></div><h2 id="dyn-compatibility" class="section-header">Dyn Compatibility<a href="#dyn-compatibility" class="anchor">§</a></h2><div class="dyn-compatibility-info"><p>This trait is <b>not</b> <a href="https://doc.rust-lang.org/nightly/reference/items/traits.html#dyn-compatibility">dyn compatible</a>.</p><p><i>In older versions of Rust, dyn compatibility was called "object safety", so this trait is not object safe.</i></p></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-ApplicationOverQuic-for-H3Driver%3CH%3E" class="impl"><a class="src rightside" href="../src/tokio_quiche/http3/driver/mod.rs.html#1126-1249">Source</a><a href="#impl-ApplicationOverQuic-for-H3Driver%3CH%3E" class="anchor">§</a><h3 class="code-header">impl&lt;H: DriverHooks&gt; <a class="trait" href="trait.ApplicationOverQuic.html" title="trait tokio_quiche::ApplicationOverQuic">ApplicationOverQuic</a> for <a class="struct" href="http3/driver/struct.H3Driver.html" title="struct tokio_quiche::http3::driver::H3Driver">H3Driver</a>&lt;H&gt;</h3></section></div><script src="../trait.impl/tokio_quiche/quic/connection/trait.ApplicationOverQuic.js" async></script><script type="text/json" id="notable-traits-data">{"&mut [u8]":"<h3>Notable traits for <code>&amp;mut [<a class=\"primitive\" href=\"https://doc.rust-lang.org/nightly/std/primitive.u8.html\">u8</a>]</code></h3><pre><code><div class=\"where\">impl <a class=\"trait\" href=\"https://doc.rust-lang.org/nightly/std/io/trait.Write.html\" title=\"trait std::io::Write\">Write</a> for &amp;mut [<a class=\"primitive\" href=\"https://doc.rust-lang.org/nightly/std/primitive.u8.html\">u8</a>]</div>"}</script></section></div></main></body></html>